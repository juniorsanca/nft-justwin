<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>DOODLE JUMP</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    
    <!--<META HTTP-EQUIV='Content-Security-Policy' CONTENT="default-src 'self';script-src 'self' 'unsafe-inline' *.disqus.com a.disquscdn.com requirejs.org www.google-analytics.com; style-src 'self' 'unsafe-inline' a.disquscdn.com; img-src 'self' *; media-src 'self' ; frame-src disqus.com;">
    -->
    <meta http-equiv="Content-Security-Policy" content="default-src * self blob: data: gap:; style-src * self 'unsafe-inline' blob: data: gap:; script-src * 'self' 'unsafe-eval' 'unsafe-inline' blob: data: gap:; object-src * 'self' blob: data: gap:; img-src * self 'unsafe-inline' blob: data: gap:; connect-src self * 'unsafe-inline' blob: data: gap:; frame-src * self blob: data: gap:;">

    <script src="https://cdn.tailwindcss.com"></script>

<style>

    body{
        background-image: url("./public/images/phone-bg.jpeg");
    }
    
</style>
</head>

<body class="px-1 py-2.5 text-center mr-0 mb-2">
<div class="">
  <div>
    <div class="px-1 py-2.5 text-center mr-0 mb-2">
        <img alt="Vue logo" src="./public/images/justwin.gif">
    </div>

<div>
    <div>
      <input class="
        font-sans text-center text-white font-bold
        shadow-lg shadow-cyan-500/50
        bg-black rounded-full
        border border-cyan-300
        w-64 p-2 mb-6 placeholder-white
        outline-none"
        placeholder="NAME" 
        type="text"
        id="username"
        name="username">
    </div>

    <div>
      <input class="
        font-sans text-center text-white font-bold
        shadow-lg shadow-cyan-500/50 bg-black
        rounded-full border border-cyan-300 
        w-64 p-2 mb-6 placeholder-white
        outline-none"
        placeholder="EMAIL" 
        type="email" 
        id="email"
        name="email" required>
    </div>

    <div>
      <input class="
        font-sans text-center text-white font-bold

        shadow-lg shadow-cyan-500/50 bg-black
        rounded-full border border-cyan-300 
        w-64 p-2 mb-6 placeholder-white
 
        outline-none" 
        placeholder="PASSWORD" 
        type="password" 
        id="password"
        name="password">
    </div>

    <div>
    <input class="   
        font-sans text-center text-white font-bold
        bg-dark-200 w-64 border border-pink-500
        placeholder-white rounded-full text-sm px-5 
        py-2.5 mr-2 mb-2 dark:bg-gray-800 bg-black 
        
        outline-none"
      type="submit" 
      id="sighUp" 
      name="signup_submit" 
      value="SignUp"
    
    ><br>
    <!-- <button id="btn" class="text-white">Submit</button>  -->
    <div>
  </div>
</div>


  <br> 
  <div class=" grid grid-cols-3 gap-3 content-evenly ...">
    <div>
        <hr class="w-18 h-2 place-content-center">
    </div>
      <div>
          <small class="text-white font-bold">Sign Up Using</small>
      </div>
    <div>
        <hr class="w-18 place-content-center">
    </div>
  </div>
  <br>
    <div class="flex space-x-3 justify-center">
      <div>
          <button id="googleRegister"> 
            <img class="h-6 w-6" alt="Vue logo" src="./public/images/google.png">
          </button><br>
      </div>
      <div>
          <button id="facebookRegister"> 
            <img class="h-6 w-6" alt="Vue logo" src="./public/images/facebook.png">
          </button><br>
      </div>
      <!--
      <div>
          <button @click="twitterConnect"> 
            <img class="h-8 w-8" alt="Vue logo" src="./public/images/twitter.png">
          </button><br>
      </div>
      -->
 
  </div>

    <div>
        <small class="text-white">
          Already have account ?
        <a href="/login" class="text-pink-500">Login</router-link>
        </small>
    </div>
    <br>
</div>

<!--<script type="module" src="./public/register.js" ></script>-->

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.7.0/firebase-app.js";
  import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/9.7.0/firebase-database.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.7.0/firebase-auth.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    /*
    const firebaseConfig = {
    apiKey: "AIzaSyAZwCEok0wHa9SdkpOrquiO1zSc2C8E104",
    authDomain: "adduser-a6f43.firebaseapp.com",
    databaseURL: "https://adduser-a6f43-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "adduser-a6f43",
    storageBucket: "adduser-a6f43.appspot.com",
    messagingSenderId: "1094690030864",
    appId: "1:1094690030864:web:1b2d830dc041d4226c1195",
    measurementId: "G-B86THF320Y"
    };
*/
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDNY0drJfhyqxBiuONq-AMTjCR1pA0U810",
  authDomain: "justwin-2e222.firebaseapp.com",
  databaseURL: "https://justwin-2e222-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "justwin-2e222",
  storageBucket: "justwin-2e222.appspot.com",
  messagingSenderId: "319970877026",
  appId: "1:319970877026:web:cb144129664f9aec707b3b",
  measurementId: "G-4QSJ5VJBWF"
};
  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);
  const auth = getAuth();

sighUp.addEventListener('click',(e) => {

  var email = document.getElementById('email').value;
  var password = document.getElementById('password').value;
  var username = document.getElementById('username').value;

  createUserWithEmailAndPassword(auth, email, password)
    .then((userCredential) => {
     // Signed in 
      const user = userCredential.user;

      set(ref(database, 'users/' + user.uid),{
          username: username,
          email: email
      })

      alert('user created!');
      // ...
    })
    .catch((error) => {
      const errorCode = error.code;
      const errorMessage = error.message;

      alert(errorMessage);
    // ..
    });

});

 login.addEventListener('click',(e)=>{
   var email = document.getElementById('email').value;
   var password = document.getElementById('password').value;

      signInWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // Signed in 
        const user = userCredential.user;

        const dt = new Date();
         update(ref(database, 'users/' + user.uid),{
          last_login: dt,
        })

         alert('User loged in!');
        // ...
      })
      .catch((error) => {
        const errorCode = error.code;
        const errorMessage = error.message;

        alert(errorMessage);
  });

 });

const user = auth.currentUser;
onAuthStateChanged(auth, (user) => {
  if (user) {
    // User is signed in, see docs for a list of available properties
    // https://firebase.google.com/docs/reference/js/firebase.User
    const uid = user.uid;
    //bla bla bla
    // ...
  } else {
    // User is signed out
    // ...
    //bla bla bla
  }
});

logout.addEventListener('click',(e)=>{

   signOut(auth).then(() => {
     // Sign-out successful.
     alert('user loged out');
   }).catch((error) => {
     // An error happened.
     const errorCode = error.code;
     const errorMessage = error.message;

        alert(errorMessage);
   });

});

</script>
</body>
</html>